[
    {
        "type" : "emr_serverless",
        "run_name": "emrs_convert_fullyear_6w",
        "script_name": "emrserverless_scripts/convert_to_parquet_and_type_conv.py",
        "arguments": [
            "{s3_bucket}",
            "nyc_rides_2022_csv/",
            "output/emrs_convert_and_type_conv_fullyear/6w/"
        ],
        "sparkSubmitParameters": {
            "spark.hadoop.hive.metastore.client.factory.class": "com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory",
            "spark.executor.instances" : "2",
            "spark.dynamicAllocation.initialExecutors" : "6",
            "spark.dynamicAllocation.maxExecutors" : "6",
            "spark.executor.cores" : "4",
            "spark.executor.memory" : "16G"
        }
    }
]